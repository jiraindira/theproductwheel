---
const { title, price, rating, reviews_count, url, description } = Astro.props;

function hostname(url) {
  try {
    return new URL(url).hostname.replace(/^www\./, "");
  } catch {
    return "";
  }
}

const site = hostname(url);
---

<article class="border-b border-gray-200 pb-6">
  <div class="flex items-start justify-between gap-6">
    <div class="min-w-0">
      <!-- Title -->
      <h3 class="text-base font-semibold text-gray-900 leading-snug">
        {title}
      </h3>

      <!-- Meta -->
      <div class="mt-2 text-xs text-gray-500">
        {typeof rating === "number" ? <span>{rating.toFixed(1)}★</span> : null}
        {typeof reviews_count === "number" ? (
          <span>{typeof rating === "number" ? " · " : ""}{reviews_count.toLocaleString()} reviews</span>
        ) : null}
        {price ? (
          <span>{(rating || reviews_count) ? " · " : ""}{price}</span>
        ) : null}
        {site ? (
          <span>{(rating || reviews_count || price) ? " · " : ""}{site}</span>
        ) : null}
      </div>

      <!-- Description -->
      {description && (
        <p class="mt-3 text-sm text-gray-700 leading-relaxed max-w-2xl">
          {description}
        </p>
      )}
    </div>

    <!-- CTA -->
    <div class="shrink-0 pt-1">
      <a
        href={url}
        rel="sponsored nofollow"
        class="text-sm font-semibold text-blue-600 hover:text-blue-700 whitespace-nowrap"
      >
        Check price →
      </a>
    </div>
  </div>
</article>

---
import type { CollectionEntry } from "astro:content";

const { posts = [], title = "The latest", viewAllHref = "/posts" } = Astro.props as {
  posts: CollectionEntry<"posts">[];
  title?: string;
  viewAllHref?: string;
};

function formatDate(d: Date) {
  try {
    return new Date(d).toLocaleDateString("en-GB", {
      day: "2-digit",
      month: "long",
      year: "numeric",
    });
  } catch {
    return "";
  }
}
---

<div>
  <div class="flex items-end justify-between">
    <h2 class="text-base font-bold tracking-tight text-gray-900">{title}</h2>
    <a href={viewAllHref} class="text-sm font-semibold text-blue-700 hover:text-blue-800">
      View all â†’
    </a>
  </div>

  <hr class="mt-4 border-t-2 border-gray-900/25" />

  <div class="mt-6 space-y-6">
    {posts.slice(0, 6).map((post) => (
      <a href={`/posts/${post.slug}`} class="block group">
        <div class="text-xs text-gray-500">{formatDate(post.data.publishedAt)}</div>
        <div class="mt-2 text-base font-semibold leading-snug text-gray-900 group-hover:text-blue-800">
          {post.data.title}
        </div>
      </a>
    ))}
  </div>
</div>

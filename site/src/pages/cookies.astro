---
import SiteLayout from "../layouts/SiteLayout.astro";
import { getTaxonomy } from "../lib/taxonomy";

const taxonomy = await getTaxonomy();
---

<SiteLayout
  title="Cookies"
  description={`How ${taxonomy.brand.name} uses cookies and analytics.`}
  canonical="/cookies"
>
  <div class="max-w-3xl mx-auto px-6 py-12">
    <header>
      <h1 class="text-3xl font-semibold tracking-tight text-gray-900">Cookies</h1>
      <p class="mt-3 text-base text-gray-700">
        This page explains how {taxonomy.brand.name} uses cookies and similar
        technologies.
      </p>
    </header>

    <section class="mt-10 prose prose-gray max-w-none">
      <h2>What we use cookies for</h2>
      <ul>
        <li>
          <strong>Analytics (optional):</strong> if you accept analytics cookies,
          we use Google Analytics to understand which guides people read and
          which outbound links they click.
        </li>
      </ul>

      <h2>Your choices</h2>
      <p>
        You can accept or reject analytics cookies using the banner shown at the
        bottom of the site. If you already made a choice and want to change it,
        use the button below.
      </p>

      <button
        id="reset-cookie-consent"
        class="mt-2 inline-flex items-center justify-center rounded-2xl border border-gray-200 bg-white px-4 py-3 text-sm font-semibold text-gray-900 hover:bg-gray-50"
        type="button"
      >
        Reset cookie preferences
      </button>

      <p class="text-sm text-gray-600">
        Resetting will refresh this page and show the banner again.
      </p>
    </section>
  </div>
</SiteLayout>

<script>
  (() => {
    const btn = document.getElementById("reset-cookie-consent");
    if (!(btn instanceof HTMLButtonElement)) return;

    btn.addEventListener("click", () => {
      // Keep this in sync with the site-wide cookie name.
      document.cookie = "tpw_cookie_consent=; Max-Age=0; path=/; samesite=lax";
      location.reload();
    });
  })();
</script>
